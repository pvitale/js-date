<html>
<head>
    <script type="text/javascript" src="../src/date.core.js"></script>
    <script type="text/javascript" src="../src/date.field.js"></script>
    <script type="text/javascript" src="../src/date.field.year.js"></script>
    <script type="text/javascript" src="../src/date.field.month.js"></script>
    <script type="text/javascript" src="../src/date.field.date.js"></script>
    <script type="text/javascript" src="../src/date.field.hour.js"></script>
    <script type="text/javascript" src="../src/date.field.minute.js"></script>
    <script type="text/javascript" src="../src/date.field.second.js"></script>
    <script type="text/javascript" src="../src/date.field.millisecond.js"></script>

    <script type="text/javascript" src="../src/date.field.day.js"></script>
    <script type="text/javascript" src="../src/date.field.week.js"></script>
    <script type="text/javascript" src="../src/date.field.weekOfMonth.js"></script>
    <script type="text/javascript" src="../src/date.timezone.js"></script>
    <script type="text/javascript" src="../src/date.timezone.CET.js"></script>
    <script type="text/javascript" src="../src/date.calendar.js"></script>
    <script type="text/javascript" src="../src/date.formatter.js"></script>

    <script type="text/javascript" src="./test.js"></script>
    <script type="text/javascript" src="./test.date.field.year.js"></script>
    <script type="text/javascript" src="./test.date.field.month.js"></script>
    <script type="text/javascript" src="./test.date.field.date.js"></script>
    <script type="text/javascript" src="./test.date.field.hour.js"></script>
    <script type="text/javascript" src="./test.date.field.minute.js"></script>
    <script type="text/javascript" src="./test.date.field.second.js"></script>
    <script type="text/javascript" src="./test.date.field.millisecond.js"></script>

    <script type="text/javascript" src="./test.date.field.day.js"></script>
    <script type="text/javascript" src="./test.date.field.week.js"></script>
    <script type="text/javascript" src="./test.date.field.weekOfMonth.js"></script>
    <script type="text/javascript" src="./test.date.timezone.js"></script>
    <script type="text/javascript" src="./test.date.calendar.js"></script>
    <script type="text/javascript" src="./test.date.formatter.js"></script>

    <style type="text/css">
        li.success {
            background: green;
        }

        li.failure {
            color: red;
        }

        li.failure ul li.success {
            display: none;
        }

        li.success ul {
            display: none;
        }
    </style>
</head>
<body onload="run();">
<ul id="root"></ul>
<script type="text/javascript">
    function $(id) {
        return document.getElementById(id);
    }

	function runNumber() {
		var time = new Date().getTime();
	    var count = 100;
		
		while (--count !== 0) {
		    if (1313452800000 !== new Date().calendar().clearTime().time()) {
				throw new Error("Invalid");
			}
		}

        append("root", "Finished in " + (new Date().getTime() - time) + "ms");
	}
	
    function run() {
		var time = new Date().getTime();
		
        runSuite("DateTime.Field.Year.Test", DateTime.Field.Year.Test);
        runSuite("DateTime.Field.Month.Test", DateTime.Field.Month.Test);
        runSuite("DateTime.Field.Date.Test", DateTime.Field.Date.Test);
        runSuite("DateTime.Field.Hour.Test", DateTime.Field.Hour.Test);
        runSuite("DateTime.Field.Minute.Test", DateTime.Field.Minute.Test);
        runSuite("DateTime.Field.Second.Test", DateTime.Field.Second.Test);
        runSuite("DateTime.Field.Millisecond.Test", DateTime.Field.Millisecond.Test);

        runSuite("DateTime.Field.Day.Test", DateTime.Field.Day.Test);
        runSuite("DateTime.Field.Week.Test", DateTime.Field.Week.Test);
        runSuite("DateTime.Field.WeekOfMonth.Test", DateTime.Field.WeekOfMonth.Test);
        runSuite("DateTime.TimeZone.Test", DateTime.TimeZone.Test);
        runSuite("DateTime.Calendar.Test", DateTime.Calendar.Test);
        runSuite("DateTime.Formatter.Test", DateTime.Formatter.Test);

        append("root", "Finished in " + (new Date().getTime() - time) + "ms");
    }

    function runSuite(name, test) {
        var success = true;
        append("root", name + " <span id='" + name+ "_result'></span><ul id='" + name + "'></ul>");

        var resultContainer = $(name + "_result");
        var suiteContainer = $(name);

        resultContainer.innerHTML = "Running...";

        var cs, cf, elem;

        cs = cf = 0;

        for (var i in test) {
            var f = test[i];

            if (typeof (f) === "function") {
                try {
                    f.call(this);

                    elem = append(name, "Success " + i);

					elem.setAttribute("class", "success");
					elem.setAttribute("className", "success");
					
                    cs++;
                } catch (e) {
                    elem = append(name, "Failure " + i + ": " + e.message);
					
					elem.setAttribute("class", "failure");
					elem.setAttribute("className", "failure");

                    success = false;

                    cf++;
                }
            }
        }

        resultContainer.innerHTML = success ? "(" + cs + ") Success" : "(" + cf + ") Failure. (" + cs + ") Success.";
        suiteContainer.parentNode.setAttribute("class", success ? "success" : "failure");
        suiteContainer.parentNode.setAttribute("className", success ? "success" : "failure");
    }

    function append(id, html) {
        var elem = document.createElement("li");

        $(id).appendChild(elem);

        elem.innerHTML = html;

        return elem;
    }
</script>
</body>
</html>